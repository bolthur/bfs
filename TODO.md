
# Things to be done

- [x] Test and fix library, so that it will also compile under linux
- [ ] Provide necessary fallback stuff, so that library can also be used without c library
- [x] Finish FAT library read support
  - [x] Finish implementation of `fat_file_read`
- [x] Add FAT library write support
  - [x] Add test where cluster chain needs to be extended <= Within truncate tests
  - [x] Extend test creating a folder to fail on second try
  - [x] Add test creating a directory with long name
  - [x] Add file write support
  - [x] Add tests for file truncate
  - [x] Add logic to support O_TRUNC on open
  - [x] Add test for creating a plain file with O_CREAT
  - [x] Add test for file truncation on open with O_TRUNC
  - [x] Add test to ensure that read only is working correctly
  - [x] Add test to read a write only opened file
  - [x] Add test for write append with O_APPEND
  - [x] Add test for writing a file
  - [x] Add test creating a file with short name
  - [x] Add test creating a file with long name
  - [x] Add test creating a file with short name but long extension, e.g. foo.jpeg
- [x] Fix read out of directory via fat directory next when switching to new cluster
- [x] Implement fat_file_move
- [x] Implement fat_file_remove
- [x] Implement fat_directory_remove
- [x] Implement fat_directory_move
- [x] Check and add proper handling for empty files, which means start cluster is 0
  - [x] Truncate with size 0 should free cluster chain
  - [x] Write needs to be adjusted so that it requests a cluster on demand
- [x] Fix directory deletion to set deletion value instead of 0 overwrite
- [x] Copy file entry information on move like creation date
- [x] Adjust cluster of directory entry `..` on folder move
- [x] Add test to ensure `..` is changed correctly
- [x] Something in the implementation destroys the fat image
- [x] Add write transaction instead of direct writing with some sort of cache accessed
- [ ] Add proper locking to library functions
- [ ] Optimizations
  - [ ] Cache open directory data blocks in memory for faster reading
- [ ] Cleanup
  - [ ] Check written code and simplify it once everything works
  - [ ] Check code and deduplicate similar code like file move or folder move
  - [ ] Extend functions by transactions where it might be necessary
- [x] Split up tests in single files
- [x] Create unit tests
  - [x] Prepare unit testing with cmake and ctest
  - [x] Prepare a test blockdev driver for unit testing
  - [x] Add unit tests for specific functions
- [ ] Add support for ext2
- [x] Fix and complete documentation
- [x] Add custom commands to test folder to create necessary images for tests
- [x] Check usages of block size and evaluate whether automatical adjustment is meaningful for fat
- [x] Add code coverage collection
  - [x] Get ctest coverage command to run
  - [x] Get html coverage output
